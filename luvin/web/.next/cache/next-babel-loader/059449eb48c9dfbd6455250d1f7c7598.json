{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useMemo, useEffect } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport numeral from \"numeral\";\nimport capitalize from \"lodash/capitalize\";\nimport sum from \"lodash/sum\";\nimport includes from \"lodash/includes\";\nimport ReactPaginate from \"react-paginate\";\nimport Content from \"../../components/Layout/Content\";\nimport Loading from \"../../components/UI/Loading\";\nimport { getProducts, resetState } from \"../../actions/products\";\nimport { addProduct } from \"../../actions/cart\";\n\nconst categoryStateSelector = state => state.categories;\n\nconst productsStateSelector = state => state.products;\n\nconst cartStateSelector = state => state.cart;\n\nfunction Category({\n  categorySlug\n}) {\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const {\n    categories\n  } = useSelector(categoryStateSelector);\n  const {\n    products,\n    total,\n    page,\n    limit,\n    sort,\n    type,\n    origin,\n    loading,\n    fetched,\n    errorMessage\n  } = useSelector(productsStateSelector);\n  const {\n    products: cartProducts\n  } = useSelector(cartStateSelector);\n  const categoryDetail = useMemo(() => {\n    return categories.find(({\n      slug\n    }) => categorySlug === slug) || {};\n  }, [categorySlug]);\n  const productIdsSelected = useMemo(() => cartProducts.map(_id => _id));\n  useEffect(() => {\n    if (!products.length) {\n      dispatch(getProducts(categorySlug, 12, 1));\n    }\n\n    return () => {\n      dispatch(resetState());\n    };\n  }, []);\n  useEffect(() => {\n    if (Category.isRendered) {\n      dispatch(getProducts(router.query.category, 12, 1));\n    }\n\n    Category.isRendered = true;\n  }, [router.query.category]);\n  return __jsx(Content, {\n    className: \"archive tax-product_cat term-ruou-vang term-15 wp-custom-logo theme-hello-elementor woocommerce woocommerce-page woocommerce-js elementor-default elementor-template-full-width elementor-kit-76 elementor-page-503\"\n  }, loading && __jsx(Loading, null), __jsx(\"div\", {\n    className: \"elementor elementor-503 elementor-location-archive product\"\n  }, __jsx(\"div\", {\n    className: \"elementor-section-wrap\"\n  }, __jsx(\"section\", {\n    className: \"elementor-section elementor-top-section elementor-element elementor-element-fd23492 elementor-section-boxed elementor-section-height-default elementor-section-height-default\"\n  }, __jsx(\"div\", {\n    className: \"elementor-container elementor-column-gap-default\"\n  }, __jsx(\"div\", {\n    className: \"elementor-row\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-b471e94\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column-wrap elementor-element-populated\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-wrap\"\n  }, __jsx(\"div\", {\n    style: {\n      display: \"block\"\n    },\n    className: \"elementor-element elementor-element-9fa1cba elementor-widget elementor-widget-theme-archive-title elementor-page-title elementor-widget-heading\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"h1\", {\n    className: \"elementor-heading-title elementor-size-default\"\n  }, categoryDetail.name))), __jsx(\"section\", {\n    className: \"elementor-section elementor-inner-section elementor-element elementor-element-4f3942e elementor-section-content-middle elementor-section-boxed elementor-section-height-default elementor-section-height-default\"\n  }, __jsx(\"div\", {\n    className: \"elementor-container elementor-column-gap-default\"\n  }, __jsx(\"div\", {\n    className: \"elementor-row\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column elementor-col-25 elementor-inner-column elementor-element elementor-element-22b68fc\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column-wrap elementor-element-populated\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-wrap\"\n  }, __jsx(\"div\", {\n    className: \"elementor-element elementor-element-27e2282 elementor-widget elementor-widget-heading\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"p\", {\n    className: \"elementor-heading-title elementor-size-default\"\n  }, \"Hi\\u1EC3n th\\u1ECB \", (page - 1) * limit + 1, \"\\u2013\", page * limit, \" tr\\xEAn \", total, \" s\\u1EA3n ph\\u1EA9m\")))))), __jsx(\"div\", {\n    className: \"elementor-column elementor-col-25 elementor-inner-column elementor-element elementor-element-2b3f6e1\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column-wrap elementor-element-populated\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-wrap\"\n  }, __jsx(\"div\", {\n    className: \"elementor-element elementor-element-15076ad elementor-widget elementor-widget-html\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"div\", {\n    className: \"elementor-element elementor-element-1a01a6d notitle elementor-widget elementor-widget-wp-widget-woocommerce_layered_nav\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"div\", {\n    className: \"woocommerce widget_layered_nav woocommerce-widget-layered-nav\"\n  }, __jsx(\"h5\", null, \"L\\u1ECDc theo\"), __jsx(\"form\", {\n    className: \"woocommerce-widget-layered-nav-dropdown\"\n  }, __jsx(\"select\", {\n    className: \"woocommerce-widget-layered-nav-dropdown\",\n    tabindex: \"-1\",\n    \"aria-hidden\": \"true\",\n    value: sort,\n    onChange: event => {\n      dispatch(getProducts(categorySlug, limit, 1, event.target.value, type, origin));\n    }\n  }, __jsx(\"option\", {\n    value: \"\"\n  }, \"L\\u1ECDc theo\"), __jsx(\"option\", {\n    value: \"descTime\"\n  }, \"M\\u1EDBi nh\\u1EA5t\"), __jsx(\"option\", {\n    value: \"ascPrice\"\n  }, \"Gi\\xE1 t\\u1EEB th\\u1EA5p \\u0111\\u1EBFn cao\"), __jsx(\"option\", {\n    value: \"descPrice\"\n  }, \"Gi\\xE1 t\\u1EEB cao \\u0111\\u1EBFn th\\u1EA5p\"))))))))))), __jsx(\"div\", {\n    className: \"elementor-column elementor-col-25 elementor-inner-column elementor-element elementor-element-d3e870e\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column-wrap elementor-element-populated\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-wrap\"\n  }, __jsx(\"div\", {\n    className: \"elementor-element elementor-element-1a01a6d notitle elementor-widget elementor-widget-wp-widget-woocommerce_layered_nav\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"div\", {\n    className: \"woocommerce widget_layered_nav woocommerce-widget-layered-nav\"\n  }, __jsx(\"h5\", null, \"L\\u1ECDc theo\"), __jsx(\"form\", {\n    className: \"woocommerce-widget-layered-nav-dropdown\"\n  }, __jsx(\"select\", {\n    className: \"woocommerce-widget-layered-nav-dropdown dropdown_layered_nav_loai-vang\",\n    value: type,\n    onChange: event => {\n      dispatch(getProducts(categorySlug, limit, 1, sort, event.target.value, origin));\n    }\n  }, __jsx(\"option\", {\n    value: \"\"\n  }, \"B\\u1EA5t k\\u1EF3 Lo\\u1EA1i vang\"), __jsx(\"option\", {\n    value: \"vang \\u0111\\u1ECF\"\n  }, \"Vang \\u0111\\u1ECF\"), __jsx(\"option\", {\n    value: \"vang h\\u1ED3ng\"\n  }, \"Vang h\\u1ED3ng\"), __jsx(\"option\", {\n    value: \"vang n\\u1ED5\"\n  }, \"Vang n\\u1ED5\"), __jsx(\"option\", {\n    value: \"vang tr\\u1EAFng\"\n  }, \"Vang tr\\u1EAFng\"))))))))), __jsx(\"div\", {\n    className: \"elementor-column elementor-col-25 elementor-inner-column elementor-element elementor-element-09fb8ac\"\n  }, __jsx(\"div\", {\n    className: \"elementor-column-wrap elementor-element-populated\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-wrap\"\n  }, __jsx(\"div\", {\n    className: \"elementor-element elementor-element-85e4633 notitle elementor-widget elementor-widget-wp-widget-woocommerce_layered_nav\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"div\", {\n    className: \"woocommerce widget_layered_nav woocommerce-widget-layered-nav\"\n  }, __jsx(\"h5\", null, \"L\\u1ECDc theo\"), __jsx(\"form\", {\n    className: \"woocommerce-widget-layered-nav-dropdown\"\n  }, __jsx(\"select\", {\n    className: \"woocommerce-widget-layered-nav-dropdown dropdown_layered_nav_nguon-goc-vang\",\n    value: origin,\n    onChange: event => {\n      dispatch(getProducts(categorySlug, limit, 1, sort, type, event.target.value));\n    }\n  }, __jsx(\"option\", {\n    value: \"\"\n  }, \"B\\u1EA5t k\\u1EF3 Ngu\\u1ED3n g\\u1ED1c vang\"), __jsx(\"option\", {\n    value: \"\\u0111\\u1EE9c\"\n  }, \"\\u0110\\u1EE9c\"), __jsx(\"option\", {\n    value: \"hungary\"\n  }, \"Hungary\"), __jsx(\"option\", {\n    value: \"new zealand\"\n  }, \"New Zealand\"), __jsx(\"option\", {\n    value: \"nga\"\n  }, \"Nga\"), __jsx(\"option\", {\n    value: \"ph\\xE1p\"\n  }, \"Ph\\xE1p\"), __jsx(\"option\", {\n    value: \"scotland\"\n  }, \"Scotland\"), __jsx(\"option\", {\n    value: \"vi\\u1EC7t nam\"\n  }, \"Vi\\u1EC7t Nam\")))))))))))), __jsx(\"div\", {\n    className: \"elementor-element elementor-element-477d2cd elementor-products-grid elementor-wc-products elementor-show-pagination-border-yes elementor-widget elementor-widget-wc-archive-products\"\n  }, __jsx(\"div\", {\n    className: \"elementor-widget-container\"\n  }, __jsx(\"div\", {\n    className: \"woocommerce columns-3\"\n  }, __jsx(\"div\", {\n    className: \"woocommerce-notices-wrapper\"\n  }), __jsx(\"ul\", {\n    className: \"products columns-3\"\n  }, products.map(product => {\n    const {\n      _id,\n      slug,\n      ident,\n      name,\n      description,\n      type,\n      origin,\n      discount,\n      price,\n      reviews,\n      images\n    } = product;\n    const discountPercent = Math.ceil(discount / price * 100);\n    const totalRate = sum(reviews.map(({\n      rate\n    }) => rate || 0));\n    const ratePercent = totalRate / reviews.length / 5 * 100;\n    const isInCart = includes(productIdsSelected, _id);\n    return __jsx(\"li\", {\n      className: \"product type-product post-280 status-publish first instock product_cat-banh-mi product_cat-ruou-vang has-post-thumbnail sale shipping-taxable purchasable product-type-simple\",\n      key: ident\n    }, __jsx(Link, {\n      href: \"/[category]/[slug].js\",\n      as: `/${categorySlug}/${slug}`\n    }, __jsx(\"a\", {\n      className: \"woocommerce-LoopProduct-link woocommerce-loop-product__link\"\n    }, __jsx(\"img\", {\n      width: \"300\",\n      height: \"360\",\n      src: images[0],\n      className: \"attachment-woocommerce_thumbnail size-woocommerce_thumbnail\",\n      alt: \"\"\n    }), !!discountPercent && __jsx(\"div\", {\n      className: \"wapl-label-id-484 label-wrap wapl-corner label-red wapl-alignnone\"\n    }, __jsx(\"span\", {\n      className: \"woocommerce-advanced-product-label product-label label-red\"\n    }, __jsx(\"span\", {\n      className: \"wapl-label-text\"\n    }, discountPercent, \"%\"))), __jsx(\"h2\", {\n      className: \"woocommerce-loop-product__title\"\n    }, name), !!ratePercent && __jsx(\"div\", {\n      className: \"star-rating\",\n      role: \"img\",\n      \"aria-label\": `Được xếp hạng ${totalRate / reviews.length} 5 sao`\n    }, __jsx(\"span\", {\n      style: {\n        width: `${ratePercent}%`\n      }\n    }, \"\\u0110\\u01B0\\u1EE3c x\\u1EBFp h\\u1EA1ng\", \" \", __jsx(\"strong\", {\n      class: \"rating\"\n    }, totalRate / reviews.length), \" \", \"5 sao\")), __jsx(\"span\", {\n      className: \"price\"\n    }, !!discountPercent && __jsx(\"del\", null, __jsx(\"span\", {\n      className: \"woocommerce-Price-amount amount\"\n    }, __jsx(\"bdi\", null, numeral(price).format(\"0,0\"), __jsx(\"span\", {\n      className: \"woocommerce-Price-currencySymbol\"\n    }, \"\\u20AB\")))), __jsx(\"ins\", null, __jsx(\"span\", {\n      className: \"woocommerce-Price-amount amount\"\n    }, __jsx(\"bdi\", null, numeral(price - discount).format(\"0,0\"), __jsx(\"span\", {\n      className: \"woocommerce-Price-currencySymbol\"\n    }, \"\\u20AB\"))))), __jsx(\"p\", {\n      className: \"arterm\"\n    }, __jsx(\"i\", {\n      className: \"fas fa-wine-bottle\"\n    }), \"\\xA0\", capitalize(type)), __jsx(\"p\", {\n      className: \"arterm\"\n    }, __jsx(\"i\", {\n      className: \"fas fa-globe-africa\"\n    }), \"\\xA0\", capitalize(origin)), __jsx(\"p\", {\n      className: \"arterm\"\n    }, __jsx(\"i\", {\n      className: \"fas fa-info-circle\"\n    }), \"\\xA0\", description), \" \")), __jsx(\"a\", {\n      style: {\n        cursor: \"pointer\"\n      },\n      className: \"button product_type_simple add_to_cart_button ajax_add_to_cart\",\n      onClick: () => dispatch(addProduct(1, product))\n    }, \"\\u0110\\u1EB7t mua\"));\n  })), !!Math.ceil(total / limit) && __jsx(\"nav\", {\n    className: \"woocommerce-pagination\"\n  }, __jsx(ReactPaginate, {\n    previousLabel: \"<\",\n    nextLabel: \">\",\n    forcePage: page - 1,\n    breakLabel: \"...\",\n    breakClassName: \"break-me\",\n    pageCount: Math.ceil(total / limit),\n    marginPagesDisplayed: 2,\n    pageRangeDisplayed: 3,\n    onPageChange: page => {\n      dispatch(getProducts(categorySlug, limit, page.selected + 1, sort, type, origin));\n    },\n    containerClassName: \"page-numbers\",\n    activeLinkClassName: \"current\",\n    pageLinkClassName: \"page-numbers\"\n  }))))))))))))));\n}\n\nCategory.getInitialProps = async props => {\n  const {\n    store,\n    req,\n    accessToken,\n    query\n  } = props.ctx;\n  const {\n    category: categorySlug\n  } = query;\n\n  if (!!req) {\n    store.dispatch(getProducts(categorySlug, 12, 1));\n  }\n\n  return {\n    categorySlug\n  };\n};\n\nexport default Category;","map":null,"metadata":{},"sourceType":"module"}