{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useRouter } from \"next/router\";\nimport Head from \"next/head\";\nimport sum from \"lodash/sum\";\nimport numeral from \"numeral\";\nimport moment from \"moment\";\nimport Link from \"next/link\";\nimport Content from \"../../components/Layout/Content\";\nimport { login as loginAction, register as registerAction, logout as logoutAction, updateUserInfo as updateUserInfoAction, updatePassword as updatePasswordAction } from \"../../actions/auth\";\nimport { getOrderHistory as getOrderHistoryAction } from \"../../actions/order\";\nimport cities from \"../../constants/cities\";\n\nconst authStateSelector = state => state.auth;\n\nconst orderStateSelector = state => state.order;\n\nfunction OrderHistory(prop) {\n  const dispatch = useDispatch();\n  const {\n    history\n  } = useSelector(orderStateSelector);\n  useEffect(() => {\n    dispatch(getOrderHistoryAction());\n  }, []);\n  return __jsx(\"table\", {\n    class: \"woocommerce-orders-table woocommerce-MyAccount-orders shop_table shop_table_responsive my_account_orders account-orders-table\"\n  }, __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", {\n    class: \"woocommerce-orders-table__header woocommerce-orders-table__header-order-number\"\n  }, __jsx(\"span\", {\n    class: \"nobr\"\n  }, \"\\u0110\\u01A1n h\\xE0ng\")), __jsx(\"th\", {\n    class: \"woocommerce-orders-table__header woocommerce-orders-table__header-order-date\"\n  }, __jsx(\"span\", {\n    class: \"nobr\"\n  }, \"Ng\\xE0y\")), __jsx(\"th\", {\n    class: \"woocommerce-orders-table__header woocommerce-orders-table__header-order-status\"\n  }, __jsx(\"span\", {\n    class: \"nobr\"\n  }, \"T\\xECnh tr\\u1EA1ng\")), __jsx(\"th\", {\n    class: \"woocommerce-orders-table__header woocommerce-orders-table__header-order-total\"\n  }, __jsx(\"span\", {\n    class: \"nobr\"\n  }, \"T\\u1ED5ng\")), __jsx(\"th\", {\n    class: \"woocommerce-orders-table__header woocommerce-orders-table__header-order-actions\"\n  }, __jsx(\"span\", {\n    class: \"nobr\"\n  }, \"C\\xE1c thao t\\xE1c\")))), __jsx(\"tbody\", null, history.orders.map(order => {\n    // const total = sum(\n    //   order.orderDetails.map(({ totalPrice }) => totalPrice)\n    // );\n    const totalWithoutDiscount = sum((order.orderDetails || []).map(({\n      totalPrice\n    }) => totalPrice));\n    let discount = 0;\n\n    if (order.voucher && order.voucher.value) {\n      if (order.voucher.type === \"percent\") {\n        discount = totalWithoutDiscount / 100 * order.voucher.value;\n      } else {\n        discount = order.voucher.value;\n      }\n    }\n\n    const total = totalWithoutDiscount - discount;\n    const quantity = sum(order.orderDetails.map(({\n      quantity\n    }) => quantity));\n    return __jsx(\"tr\", {\n      class: \"woocommerce-orders-table__row woocommerce-orders-table__row--status-cancelled order\"\n    }, __jsx(\"td\", {\n      class: \"woocommerce-orders-table__cell woocommerce-orders-table__cell-order-number\",\n      \"data-title\": \"\\u0110\\u01A1n h\\xE0ng\"\n    }, __jsx(Link, {\n      href: \"/tai-khoan/view-order/[orderId].js\",\n      as: `/tai-khoan/view-order/${order._id}`\n    }, __jsx(\"a\", null, order._id, \" \"))), __jsx(\"td\", {\n      class: \"woocommerce-orders-table__cell woocommerce-orders-table__cell-order-date\",\n      \"data-title\": \"Ng\\xE0y\"\n    }, __jsx(\"time\", {\n      datetime: \"2020-11-02T10:41:03+00:00\"\n    }, \" \", moment(order.createdAt).format(\"DD-MM-YYYY\"))), __jsx(\"td\", {\n      class: \"woocommerce-orders-table__cell woocommerce-orders-table__cell-order-status\",\n      \"data-title\": \"T\\xECnh tr\\u1EA1ng\"\n    }, order.status), __jsx(\"td\", {\n      class: \"woocommerce-orders-table__cell woocommerce-orders-table__cell-order-total\",\n      \"data-title\": \"T\\u1ED5ng\"\n    }, __jsx(\"span\", {\n      class: \"woocommerce-Price-amount amount\"\n    }, numeral(total).format(\"0,0\"), __jsx(\"span\", {\n      class: \"woocommerce-Price-currencySymbol\"\n    }, \"\\u20AB\")), \" \", \"cho \", quantity, \" m\\u1EE5c\"), __jsx(\"td\", {\n      class: \"woocommerce-orders-table__cell woocommerce-orders-table__cell-order-actions\",\n      \"data-title\": \"C\\xE1c thao t\\xE1c\"\n    }, __jsx(Link, {\n      href: \"/tai-khoan/view-order/[orderId].js\",\n      as: `/tai-khoan/view-order/${order._id}`\n    }, __jsx(\"a\", {\n      class: \"woocommerce-button button view\"\n    }, \"Xem\"))));\n  })));\n}\n\nfunction ChangePassword(prop) {\n  const dispatch = useDispatch();\n  const {\n    userInfo,\n    updatePassword\n  } = useSelector(authStateSelector);\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    oldPass: \"\",\n    newPass: \"\",\n    confirmNewPass: \"\"\n  });\n\n  const handleChangePassword = (prop, value) => {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      [prop]: value\n    }));\n  };\n\n  const handleUpdatePassword = event => {\n    console.log(\"on here\");\n    event.preventDefault();\n\n    if (state.newPass !== state.confirmNewPass) {\n      alert(\"Mật khẩu mới không khớp!\");\n    }\n\n    dispatch(updatePasswordAction({\n      userId: userInfo._id,\n      oldPassword: state.oldPass,\n      newPassword: state.newPass\n    }));\n  };\n\n  return __jsx(\"form\", {\n    class: \"woocommerce-EditAccountForm edit-account\",\n    onSubmit: handleUpdatePassword\n  }, __jsx(\"fieldset\", null, __jsx(\"legend\", null, \"Thay \\u0111\\u1ED5i m\\u1EADt kh\\u1EA9u\"), __jsx(\"p\", {\n    class: \"woocommerce-form-row woocommerce-form-row--wide form-row form-row-wide\"\n  }, __jsx(\"label\", {\n    for: \"password_current\"\n  }, \"M\\u1EADt kh\\u1EA9u hi\\u1EC7n t\\u1EA1i\"), __jsx(\"input\", {\n    required: true,\n    type: \"password\",\n    class: \"woocommerce-Input woocommerce-Input--password input-text\",\n    name: \"password_current\",\n    id: \"password_current\",\n    autocomplete: \"off\",\n    value: state.oldPass,\n    onChange: event => handleChangePassword(\"oldPass\", event.target.value)\n  })), __jsx(\"p\", {\n    class: \"woocommerce-form-row woocommerce-form-row--wide form-row form-row-wide\"\n  }, __jsx(\"label\", {\n    for: \"password_1\"\n  }, \"M\\u1EADt kh\\u1EA9u m\\u1EDBi\"), __jsx(\"input\", {\n    required: true,\n    type: \"password\",\n    class: \"woocommerce-Input woocommerce-Input--password input-text\",\n    name: \"password_1\",\n    id: \"password_1\",\n    autocomplete: \"off\",\n    value: state.newPass,\n    onChange: event => handleChangePassword(\"newPass\", event.target.value)\n  })), __jsx(\"p\", {\n    class: \"woocommerce-form-row woocommerce-form-row--wide form-row form-row-wide\"\n  }, __jsx(\"label\", {\n    for: \"password_2\"\n  }, \"X\\xE1c nh\\u1EADn m\\u1EADt kh\\u1EA9u m\\u1EDBi\"), __jsx(\"input\", {\n    required: true,\n    type: \"password\",\n    class: \"woocommerce-Input woocommerce-Input--password input-text\",\n    name: \"password_2\",\n    id: \"password_2\",\n    autocomplete: \"off\",\n    value: state.confirmNewPass,\n    onChange: event => handleChangePassword(\"confirmNewPass\", event.target.value)\n  }))), updatePassword.errorMessage && __jsx(\"p\", {\n    style: {\n      color: \"red\",\n      fontSize: \"14px\"\n    }\n  }, updatePassword.errorMessage), updatePassword.success && __jsx(\"p\", {\n    style: {\n      color: \"green\",\n      fontSize: \"14px\"\n    }\n  }, \"\\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u th\\xE0nh c\\xF4ng\"), __jsx(\"p\", null, __jsx(\"button\", {\n    style: {\n      marginTop: \"10px\"\n    },\n    type: \"submit\",\n    class: \"woocommerce-Button button\",\n    name: \"save_account_details\",\n    value: \"L\\u01B0u thay \\u0111\\u1ED5i\"\n  }, \"L\\u01B0u thay \\u0111\\u1ED5i\")));\n}\n\nfunction Adress(prop) {\n  const dispatch = useDispatch();\n  const {\n    userInfo,\n    updateUserInfo\n  } = useSelector(authStateSelector);\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    name: userInfo.name || \"\",\n    email: userInfo.email || \"\",\n    phone: userInfo.phone || \"\",\n    address: userInfo.address || \"\",\n    city: userInfo.city || \"\"\n  });\n\n  const handleChangeInfo = (prop, value) => {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      [prop]: value\n    }));\n  };\n\n  const handleUpdateInfo = event => {\n    event.preventDefault();\n    dispatch(updateUserInfoAction(userInfo._id, state));\n  };\n\n  return __jsx(\"form\", {\n    onSubmit: handleUpdateInfo\n  }, __jsx(\"h3\", null, \"\\u0110\\u1ECBa ch\\u1EC9 thanh to\\xE1n\"), __jsx(\"div\", {\n    class: \"woocommerce-address-fields\"\n  }, __jsx(\"div\", {\n    class: \"woocommerce-address-fields__field-wrapper\"\n  }, __jsx(\"p\", {\n    class: \"form-row form-row-wide\",\n    id: \"billing_company_field\",\n    \"data-priority\": \"30\"\n  }, __jsx(\"label\", {\n    for: \"billing_company\",\n    class: \"\"\n  }, \"T\\xEAn\\xA0\", __jsx(\"abbr\", {\n    class: \"required\",\n    title: \"b\\u1EAFt bu\\u1ED9c\"\n  }, \"*\")), __jsx(\"span\", {\n    class: \"woocommerce-input-wrapper\"\n  }, __jsx(\"input\", {\n    required: true,\n    type: \"text\",\n    class: \"input-text \",\n    name: \"billing_company\",\n    id: \"billing_company\",\n    placeholder: \"\",\n    value: state.name,\n    onChange: event => handleChangeInfo(\"name\", event.target.value)\n  }))), __jsx(\"p\", {\n    class: \"form-row form-row-first validate-required\",\n    id: \"billing_first_name_field\",\n    \"data-priority\": \"10\"\n  }, __jsx(\"label\", {\n    for: \"billing_first_name\",\n    class: \"\"\n  }, \"Phone\\xA0\", __jsx(\"abbr\", {\n    class: \"required\",\n    title: \"b\\u1EAFt bu\\u1ED9c\"\n  }, \"*\")), __jsx(\"span\", {\n    class: \"woocommerce-input-wrapper\"\n  }, __jsx(\"input\", {\n    required: true,\n    type: \"tel\",\n    class: \"input-text \",\n    name: \"billing_first_name\",\n    id: \"billing_first_name\",\n    placeholder: \"\",\n    autocomplete: \"given-name\",\n    value: state.phone,\n    onChange: event => handleChangeInfo(\"phone\", event.target.value)\n  }))), __jsx(\"p\", {\n    class: \"form-row form-row-last validate-required\",\n    id: \"billing_last_name_field\",\n    \"data-priority\": \"20\"\n  }, __jsx(\"label\", {\n    for: \"billing_last_name\",\n    class: \"\"\n  }, \"Email\\xA0\", __jsx(\"abbr\", {\n    class: \"required\",\n    title: \"b\\u1EAFt bu\\u1ED9c\"\n  }, \"*\")), __jsx(\"span\", {\n    class: \"woocommerce-input-wrapper\"\n  }, __jsx(\"input\", {\n    required: true,\n    type: \"email\",\n    class: \"input-text \",\n    name: \"billing_last_name\",\n    id: \"billing_last_name\",\n    placeholder: \"\",\n    value: state.email,\n    onChange: event => handleChangeInfo(\"email\", event.target.value)\n  }))), __jsx(\"p\", {\n    class: \"form-row address-field validate-required form-row-wide\",\n    id: \"billing_address_1_field\",\n    \"data-priority\": \"50\"\n  }, __jsx(\"label\", {\n    for: \"billing_address_1\",\n    class: \"\"\n  }, \"\\u0110\\u1ECBa ch\\u1EC9\\xA0\", __jsx(\"abbr\", {\n    class: \"required\",\n    title: \"b\\u1EAFt bu\\u1ED9c\"\n  }, \"*\")), __jsx(\"span\", {\n    class: \"woocommerce-input-wrapper\"\n  }, __jsx(\"input\", {\n    required: true,\n    type: \"text\",\n    class: \"input-text \",\n    name: \"billing_address_1\",\n    id: \"billing_address_1\",\n    placeholder: \"\\u0110\\u1ECBa ch\\u1EC9\",\n    autocomplete: \"address-line1\",\n    \"data-placeholder\": \"\\u0110\\u1ECBa ch\\u1EC9\",\n    value: state.address,\n    onChange: event => handleChangeInfo(\"address\", event.target.value)\n  }))), __jsx(\"p\", {\n    class: \"form-row address-field validate-required form-row-wide\",\n    id: \"billing_address_1_field\",\n    \"data-priority\": \"50\"\n  }, __jsx(\"label\", {\n    for: \"billing_address_1\",\n    class: \"\"\n  }, \"T\\u1EC9nh / Th\\xE0nh ph\\u1ED1 \\xA0\", __jsx(\"abbr\", {\n    class: \"required\",\n    title: \"b\\u1EAFt bu\\u1ED9c\"\n  }, \"*\")), __jsx(\"span\", {\n    class: \"woocommerce-input-wrapper\"\n  }, __jsx(\"select\", {\n    name: \"billing_city\",\n    id: \"billing_city\",\n    value: state.city,\n    className: \"input-text\",\n    onChange: event => handleChangeInfo(\"city\", event.target.value)\n  }, cities.map((city, index) => __jsx(\"option\", {\n    key: index,\n    value: city\n  }, city)))))), __jsx(\"p\", null, __jsx(\"button\", {\n    type: \"submit\",\n    class: \"button\",\n    name: \"save_address\",\n    value: \"L\\u01B0u \\u0111\\u1ECBa ch\\u1EC9\"\n  }, \"L\\u01B0u \\u0111\\u1ECBa ch\\u1EC9\")), updateUserInfo.errorMessage && __jsx(\"p\", {\n    style: {\n      color: \"red\",\n      fontSize: \"14px\"\n    }\n  }, updateUserInfo.errorMessage), updateUserInfo.success && __jsx(\"p\", {\n    style: {\n      color: \"green\",\n      fontSize: \"14px\"\n    }\n  }, \"C\\u1EADp nh\\u1EADt th\\xF4ng tin th\\xE0nh c\\xF4ng!\")));\n}\n\nfunction index(props) {\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const {\n    userInfo,\n    login,\n    register\n  } = useSelector(authStateSelector);\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    tabActive: 1\n  });\n  useEffect(() => {\n    if (!userInfo._id) {\n      router.push(\"/dang-nhap\");\n    }\n  }, [userInfo._id]);\n  return __jsx(Content, {\n    className: \"page-template-default page page-id-10 wp-custom-logo theme-hello-elementor woocommerce-account woocommerce-page woocommerce-no-js elementor-default elementor-kit-76\"\n  }, __jsx(Head, null, __jsx(\"title\", null, \"T\\xE0i kho\\u1EA3n - Luvin\"), __jsx(\"meta\", {\n    name: \"description\",\n    content: \"T\\u1EA5t c\\u1EA3 c\\xE1c s\\u1EA3n ph\\u1EA9m r\\u01B0\\u1EE3u vang \\u0111\\u01B0\\u1EE3c l\\xEAn men t\\u1EF1 nhi\\xEAn v\\xE0 c\\xF3 n\\u1ED3ng \\u0111\\u1ED9 c\\u1ED3n d\\u01B0\\u1EDBi 15 \\u0111\\u1ED9\"\n  }), __jsx(\"meta\", {\n    property: \"og:type\",\n    content: \"website\"\n  }), __jsx(\"meta\", {\n    property: \"og:title\",\n    content: `Tài khoản - Luvin`\n  }), __jsx(\"meta\", {\n    property: \"og:url\",\n    content: \"https://luvin.com.vn\"\n  }), __jsx(\"meta\", {\n    property: \"og:site_name\",\n    content: \"Luvin\"\n  }), __jsx(\"meta\", {\n    property: \"og:image\",\n    content: \"https://luvin.com.vn/images/banner.jpg\"\n  }), __jsx(\"meta\", {\n    property: \"og:image:width\",\n    content: \"1200\"\n  }), __jsx(\"meta\", {\n    property: \"og:image:height\",\n    content: \"630\"\n  })), __jsx(\"main\", {\n    className: \"site-main post-10 page type-page status-publish hentry\",\n    role: \"main\"\n  }, __jsx(\"header\", {\n    className: \"page-header\"\n  }, __jsx(\"h1\", {\n    className: \"entry-title\"\n  }, \"T\\xE0i kho\\u1EA3n\")), __jsx(\"div\", {\n    className: \"page-content\"\n  }, __jsx(\"div\", {\n    class: \"woocommerce\"\n  }, __jsx(\"nav\", {\n    class: \"woocommerce-MyAccount-navigation\"\n  }, __jsx(\"ul\", null, __jsx(\"li\", {\n    class: \"woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--dashboard is-active\"\n  }, __jsx(\"a\", {\n    style: {\n      cursor: \"pointer\"\n    },\n    onClick: () => setState(_objectSpread(_objectSpread({}, state), {}, {\n      tabActive: 1\n    }))\n  }, \"B\\u1EA3ng \\u0111i\\u1EC1u khi\\u1EC3n\")), __jsx(\"li\", {\n    class: \"woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--orders\"\n  }, __jsx(\"a\", {\n    style: {\n      cursor: \"pointer\"\n    },\n    onClick: () => setState(_objectSpread(_objectSpread({}, state), {}, {\n      tabActive: 2\n    }))\n  }, \"\\u0110\\u01A1n h\\xE0ng\")), __jsx(\"li\", {\n    class: \"woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--edit-address\"\n  }, __jsx(\"a\", {\n    style: {\n      cursor: \"pointer\"\n    },\n    onClick: () => setState(_objectSpread(_objectSpread({}, state), {}, {\n      tabActive: 3\n    }))\n  }, \"Th\\xF4ng tin c\\xE1 nh\\xE2n\")), __jsx(\"li\", {\n    class: \"woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--edit-account\"\n  }, __jsx(\"a\", {\n    style: {\n      cursor: \"pointer\"\n    },\n    onClick: () => setState(_objectSpread(_objectSpread({}, state), {}, {\n      tabActive: 4\n    }))\n  }, \"\\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u\")), __jsx(\"li\", {\n    class: \"woocommerce-MyAccount-navigation-link woocommerce-MyAccount-navigation-link--customer-logout\"\n  }, __jsx(\"a\", {\n    style: {\n      cursor: \"pointer\"\n    },\n    onClick: () => {\n      router.push(\"/\");\n      dispatch(logoutAction());\n    }\n  }, \"\\u0110\\u0103ng xu\\u1EA5t\")))), __jsx(\"div\", {\n    class: \"woocommerce-MyAccount-content\"\n  }, state.tabActive === 1 && __jsx(React.Fragment, null, __jsx(\"p\", null, \"Xin ch\\xE0o \", __jsx(\"strong\", null, userInfo.name), \" (kh\\xF4ng ph\\u1EA3i\", \" \", __jsx(\"strong\", null, userInfo.name), \"?\", \" \", __jsx(\"a\", {\n    style: {\n      cursor: \"pointer\"\n    },\n    onClick: () => {\n      router.push(\"/\");\n      dispatch(logoutAction());\n    }\n  }, \"\\u0110\\u0103ng xu\\u1EA5t\"), \")\")), state.tabActive === 2 && __jsx(OrderHistory, null), state.tabActive === 3 && __jsx(Adress, null), state.tabActive === 4 && __jsx(ChangePassword, null))))));\n}\n\nexport default index;","map":null,"metadata":{},"sourceType":"module"}